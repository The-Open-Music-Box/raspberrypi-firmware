# üéµ The Open Music Box

> Un lecteur audio tangible pour enfants : autonomie, sans √©cran, et contr√¥l√© par les parents. Les enfants explorent musique, histoires et podcasts en posant simplement des tags NFC sur le lecteur.

[![License](https://img.shields.io/badge/License-Custom-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.9+-green.svg)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-latest-teal.svg)](https://fastapi.tiangolo.com/)
[![Vue.js](https://img.shields.io/badge/Vue.js-3.x-brightgreen.svg)](https://vuejs.org/)

<a href="https://www.buymeacoffee.com/rhy6j5cdpq9" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a>

---

## üìñ Table des mati√®res

**üéØ Pr√©sentation**
- [Description du projet](#-description-du-projet)
- [Fonctionnalit√©s principales](#-fonctionnalit√©s-principales)

**üõ†Ô∏è Installation**
- [Mat√©riel requis](#-mat√©riel-requis)
- [D√©ploiement sur Raspberry Pi](#-d√©ploiement-sur-raspberry-pi)

**üîß Aspects techniques**
- [Architecture technique](#-architecture-technique)
- [Documentation](#-documentation)

**üíª D√©veloppement**
- [D√©veloppement](#-d√©veloppement)
- [Troubleshooting](#-troubleshooting)

**ü§ù Communaut√©**
- [Contribution](#-contribution)
- [License](#-license)
- [Contact](#-contact)

---

## üéØ Description du projet

**The Open Music Box** est un lecteur audio tangible con√ßu pour offrir aux enfants une exp√©rience d'√©coute autonome et sans √©cran. Les parents pr√©parent des playlists (musique, histoires, podcasts) et les associent √† des tags NFC physiques. L'enfant n'a qu'√† poser un tag sur le lecteur pour lancer instantan√©ment son contenu favori, d√©veloppant ainsi son autonomie tout en restant dans un environnement s√©curis√© et contr√¥l√© par les parents.

Bas√© sur Raspberry Pi, ce projet open source combine hardware accessible et software moderne pour cr√©er une alternative √©ducative et saine aux √©crans.

### Concept

**The Open Music Box** transforme l'√©coute audio en une exp√©rience tangible et autonome, sp√©cialement con√ßue pour les enfants. Les parents pr√©parent et associent des playlists √† des tags NFC physiques, permettant aux enfants d'explorer un univers audio riche (musique, histoires, podcasts) en toute autonomie.

- **üè∑Ô∏è Tags NFC physiques**: Chaque tag repr√©sente une playlist (album, histoire, podcast)
- **üë∂ Autonomie totale**: L'enfant choisit et lance son contenu sans aide parentale
- **üé∂ Lecture instantan√©e**: Posez un tag sur le lecteur pour d√©marrer automatiquement
- **üéõÔ∏è Contr√¥les simples**: Boutons intuitifs adapt√©s aux petites mains
- **üë®‚Äçüë©‚Äçüëß Gestion parentale**: Interface web pour pr√©parer et organiser le contenu
- **üîí Environnement s√©curis√©**: Contenu pr√©-approuv√© par les parents

### Cas d'usage principaux

#### üéØ Usage familial (cas principal)

**Pour les enfants (3-12 ans):**
- üéµ Explorer leur biblioth√®que musicale de fa√ßon autonome
- üìö √âcouter des histoires audio et livres-audio avant le coucher
- üéôÔ∏è D√©couvrir des podcasts √©ducatifs adapt√©s √† leur √¢ge
- üé® Choisir leur ambiance sonore selon leurs activit√©s (jeux, devoirs, d√©tente)
- üß© D√©velopper leur autonomie et sens de l'organisation

**Pour les parents:**
- ‚úÖ Pr√©parer des playlists th√©matiques (berceuses, comptines, histoires, musique calme)
- ‚úÖ Contr√¥ler et valider tout le contenu accessible
- ‚úÖ Cr√©er une exp√©rience sans √©cran pour leurs enfants
- ‚úÖ Associer facilement des tags aux contenus (stickers, cartes, figurines)
- ‚úÖ G√©rer √† distance via l'interface web

#### üè´ Autres usages

- **√âcoles et garderies**: Biblioth√®que audio collective pour temps calmes
- **M√©diath√®ques**: Borne d'√©coute interactive pour jeune public
- **Th√©rapie**: Outil ludique pour enfants √† besoins sp√©cifiques
- **Familles multig√©n√©rationnelles**: Interface simple pour grands-parents et enfants

---

## ‚ú® Fonctionnalit√©s principales

### üéµ Gestion de la musique

- **Playlists personnalisables**: Cr√©ez et organisez vos playlists
- **Upload de fichiers audio**: Support MP3, d'autres formats seront rajout√©s

### üè∑Ô∏è Syst√®me NFC

- **Lecture automatique**: D√©tection et lecture instantan√©e
- **Association flexible**: Liez n'importe quel tag √† n'importe quelle playlist

### üéõÔ∏è Contr√¥les et lecture

- **Boutons physiques**: Play/Pause, Suivant, Pr√©c√©dent
- **Encodeur rotatif**: Contr√¥le du volume avec bouton int√©gr√©
- **Lecture continue**: Passe automatiquement au morceau suivant

### üåê Interface web

- **Design responsive**: Compatible mobile, tablette, et desktop
- **Synchronisation temps r√©el**: WebSocket pour des mises √† jour instantan√©es
- **Interface intuitive**: UI facile √† utiliser

---

## üîå Mat√©riel requis

### Composants essentiels

| Composant | Mod√®le recommand√© | Prix approximatif |
|-----------|-------------------|-------------------|
| **Ordinateur** | [Raspberry Pi 4 (1GB RAM)](https://www.raspberrystore.nl/PrestaShop/en/raspberry-pi-v4/226-raspberry-pi-4-model-b-1gb-765756931168.html) | ~40‚Ç¨ |
| **Ordinateur** Alternative | [Zero W2](https://www.raspberrystore.nl/PrestaShop/en/raspberry-pi-zero-v1-en-v2/588-raspberry-pi-zero-2wh-5056561800011.html) | ~22‚Ç¨ |
| **Carte audio** | [Waveshare WM8960 Audio HAT](https://www.amazon.fr/IBest-Waveshare-WM8960-Audio-Raspberry/dp/B07R8M3XFQ) | ~22‚Ç¨ |
| **Lecteur NFC** | [PN532 NFC Module (I2C/SPI)](https://www.amazon.fr/communication-lecteur-Arduino-Raspberry-Smartphone/dp/B07YDG6X2V/) | ~10‚Ç¨ |
| **Carte SD** | 32GB Class 10 | ~10‚Ç¨ |
| **Alimentation** | 5V 3A USB-C (Pi 4) ou Micro-USB (Pi 3) | ~10‚Ç¨ |

### Composants optionnels

- **Boutons GPIO**: Pour contr√¥les physiques (Play/Pause, Next, Prev)
- **Encodeur rotatif**: Pour contr√¥le du volume
- **Bo√Ætier**: Pour protection et design
- **Tags NFC**: NTAG213/215/216 ou Mifare Classic (basiquement nimporte quel tag NFC peut etre utilis√©)

### Configuration mat√©rielle

- **NFC Reader**: Connect√© via I2C (GPIO 2/3) ou SPI
- **Audio HAT**: Monte directement sur les pins GPIO
- **Boutons**: GPIO configurables (voir configuration)
- **Encodeur**: GPIO pour CLK, DT, SW

---

## üöÄ D√©ploiement sur Raspberry Pi

### Vue d'ensemble

Ce guide d√©taille le processus de d√©ploiement automatis√© de l'application **The Open Music Box** sur un Raspberry Pi. Le syst√®me utilise des scripts automatis√©s pour simplifier l'installation et la configuration.

---

## 1. Cr√©ation de la carte SD

### √âtape 1: Installer Raspberry Pi Imager

1. T√©l√©chargez et installez [Raspberry Pi Imager](https://www.raspberrypi.com/software/)
2. Ins√©rez votre carte SD (minimum 16GB, recommand√© 32GB)

### √âtape 2: Configuration du syst√®me

1. **Choisir le syst√®me d'exploitation**
   - Choisissez votre modele de RasbperryPi
   - Choisir l'OS -> RaspberryPi OS (other)
   - Raspberry Pi OS lite (Bullseye) 64 ou 32 bits en fonction de votre Raspberry Pi

2. **Configuration avanc√©e** (‚öôÔ∏è Settings)
   - **Hostname**: `theopenmusicbox.local`
   - **Activer SSH**: ‚úÖ Coch√©
   - **D√©finir username/password**:
     - Username: `admin` (ou votre choix)
     - Password: [votre mot de passe s√©curis√©]
   - **Configurer le WiFi** (recommand√©):
     - SSID: [nom de votre r√©seau]
     - Password: [mot de passe WiFi]
     - Pays: [votre pays]
   - **Locale**: Fuseau horaire et clavier

3. **√âcrire sur la carte SD**
   - S√©lectionnez votre carte SD
   - Cliquez sur "Write"
   - Attendez la fin du processus (5-10 minutes)

4. **Premier d√©marrage**
   - Ins√©rez la carte SD dans le Raspberry Pi
   - Branchez l'alimentation
   - Attendez 2-3 minutes pour le premier d√©marrage
   - Le Pi devrait √™tre accessible sur le r√©seau

---

## 2. Configuration SSH et acc√®s distant

### √âtape 1: Configuration de la cl√© SSH

Ex√©cutez le script de configuration SSH depuis votre ordinateur:

```bash
./setup_ssh_key_to_rpi.sh
```

Le script vous guidera √† travers les √©tapes suivantes:

1. **S√©lection de la cl√© SSH**:
   - Utilisez une cl√© existante ou cr√©ez-en une nouvelle
   - Les cl√©s existantes sont list√©es avec num√©ros

2. **Configuration de la connexion**:
   - Username sur le Pi (ex: `admin`)
   - Adresse IP ou hostname (ex: `theopenmusicbox.local`)
   - Nom du raccourci SSH (ex: `tomb`)

3. **Copie de la cl√©**:
   - Le script copie automatiquement votre cl√© publique
   - Vous devrez entrer le mot de passe du Pi une seule fois
   - Configure `~/.ssh/config` pour un acc√®s facile

4. **Test de connexion**:
   - Le script teste automatiquement la connexion SSH
   - Vous pouvez vous connecter imm√©diatement

### Exemple de session

```bash
jonathanpiette@mac tomb-rpi % ./setup_ssh_key_to_rpi.sh

========================================
üéµ  The Open Music Box SSH Setup  üéµ
========================================

Enhanced SSH Key Setup for Raspberry Pi

üóùÔ∏è  Found existing SSH keys:
  1) id_ed25519
  2) musicbox_key
  3) rpi_local
  4) tomb
  5) Create a new key

Choose an option (1-5): 4
‚úÖ Using existing key: tomb
üë§ Username on the Raspberry Pi: admin
üåê IP address or hostname: theopenmusicbox.local
üîñ SSH shortcut name: tomb

‚úÖ Public key copied successfully
‚úÖ SSH config updated successfully
‚úÖ Passwordless SSH authentication working!

üéâ Setup completed successfully!
üíª You can now connect with: ssh tomb
```

### √âtape 2: Test de la connexion

Une fois la cl√© configur√©e, connectez-vous simplement:

```bash
ssh tomb
```

Vous devriez voir:

```
Linux theopenmusicbox 6.1.21-v8+ #1642 SMP PREEMPT Mon Apr  3 17:24:16 BST 2023 aarch64
Last login: [date]
admin@theopenmusicbox:~ $
```

---

## 3. Installation sur le Raspberry Pi

### Vue du processus d'installation

L'installation s'effectue depuis votre ordinateur via SSH avec affichage en temps r√©el:

```bash
./deploy.sh --prod tomb
```

### Processus automatique

Le script `deploy.sh` effectue les √©tapes suivantes:

1. **üß™ Tests complets**: Ex√©cution de 1500+ tests (architecture, unit√©, int√©gration)
2. **üî® Build frontend**: Compilation de l'application Vue.js
3. **üì¶ Package**: Cr√©ation du package de d√©ploiement
4. **üì§ Upload**: Transfert via rsync sur le Raspberry Pi
5. **üîÑ Restart**: Red√©marrage du service systemd
6. **üè• Health check**: V√©rification du statut du service
7. **üìä Monitoring**: Affichage des logs en temps r√©el

### Installation manuelle compl√®te

**A venir**

### Script d'installation automatique (setup.sh)

Le script `setup.sh` configure:

- ‚úÖ Environnement virtuel Python
- ‚úÖ D√©pendances Python
- ‚úÖ Configuration `.env`
- ‚úÖ Service systemd `app.service`
- ‚úÖ Permissions et propri√©t√© des fichiers

Pour lancer l'installation (env 10 minutes):
```bash
ssh tomb
cd tomb
chmod +x setup.sh
./setup.sh
```
---

## 4. Configuration finale

### V√©rification de l'installation

Apr√®s l'installation, v√©rifiez le statut du service:

```bash
sudo systemctl status app.service
```

Vous devriez voir:

```
‚óè app.service - The Open Music Box
   Loaded: loaded (/etc/systemd/system/app.service; enabled)
   Active: active (running) since [date]
   ...
```

### Configuration FTP (optionnel)

Pour faciliter le transfert de fichiers audio:

```bash
# Installation du serveur FTP
sudo apt-get install vsftpd

# Configuration
sudo nano /etc/vsftpd.conf
```

Param√®tres recommand√©s:

```
anonymous_enable=NO
local_enable=YES
write_enable=YES
chroot_local_user=YES
```

Red√©marrez le service:

```bash
sudo systemctl restart vsftpd
```

### Observation des logs

Surveillez l'application en temps r√©el:

```bash
sudo journalctl -fu app.service --output=cat
```

ou utilisez:

```bash
./deploy.sh --monitor tomb
```

---

## 5. Synchronisation et d√©ploiement continu

### D√©ploiement rapide

Pour d√©ployer des modifications:

```bash
# D√©ploiement complet avec tests
./deploy.sh --prod tomb

# D√©ploiement sans tests (plus rapide)
./deploy.sh --prod tomb --skip-tests

# D√©ploiement sans monitoring
./deploy.sh --prod tomb --no-monitor
```

### Mode d√©veloppement local

Pour tester localement avant d√©ploiement:

```bash
# D√©ploiement en d√©veloppement local
./deploy.sh --dev

# Tests seulement
./deploy.sh --test-only

# Build seulement
./deploy.sh --build-only
```

---

## 6. Commandes utiles

### Gestion du service

```bash
# V√©rifier le statut
sudo systemctl status app

# D√©marrer le service
sudo systemctl start app

# Arr√™ter le service
sudo systemctl stop app

# Red√©marrer le service
sudo systemctl restart app

# Activer au d√©marrage
sudo systemctl enable app

# D√©sactiver au d√©marrage
sudo systemctl disable app
```

### Gestion des logs

```bash
# Logs en temps r√©el
sudo journalctl -fu app.service

# Logs sans formatage
sudo journalctl -fu app.service --output=cat

# Derni√®res 100 lignes
sudo journalctl -u app.service -n 100

# Logs depuis aujourd'hui
sudo journalctl -u app.service --since today

# Logs avec erreurs seulement
sudo journalctl -u app.service -p err
```

### Gestion des fichiers

```bash
# Emplacement de l'application
cd /home/admin/tomb

# Configuration
nano /home/admin/tomb/.env

# Logs applicatifs
tail -f /home/admin/tomb/logs/app.log

# Donn√©es audio
ls -lh /home/admin/tomb/app/data/audio/

# Playlists
ls -lh /home/admin/tomb/app/data/playlists/
```

### Test du mat√©riel

```bash
# Test audio
aplay /usr/share/sounds/alsa/Front_Center.wav

# Volume syst√®me
alsamixer

# Liste des cartes audio
aplay -l

# Test NFC (si le service est arr√™t√©)
sudo i2cdetect -y 1
```

---

## 7. Acc√®s √† l'interface web

Une fois le service d√©marr√©, l'interface web est accessible:

- **URL locale**: `http://theopenmusicbox.local:5004`
- **URL IP**: `http://[IP_DU_PI]:5004`
- **Depuis le Pi**: `http://localhost:5004`

### Premi√®re utilisation

#### üë®‚Äçüë©‚Äçüëß Configuration parentale (une fois)

1. **Acc√©dez √† l'interface web** depuis votre t√©l√©phone ou ordinateur:
   - `http://theopenmusicbox.local:5004`

2. **Cr√©ez vos premi√®res playlists**:
   - üìö "Histoires du soir" - pour le coucher
   - üéµ "Comptines pr√©f√©r√©es" - pour la journ√©e
   - üéôÔ∏è "Podcasts √©ducatifs" - pour apprendre en s'amusant
   - üé∂ "Musique calme" - pour les devoirs

3. **Ajoutez du contenu**:
   - Uploadez des fichiers audio depuis votre ordinateur
   - Importez des playlists depuis YouTube
   - Organisez les pistes dans l'ordre souhait√©

4. **Associez des tags NFC**:
   - Collez un sticker ou √©tiquette sur chaque tag
   - Dans l'interface, cliquez sur "Associate NFC Tag"
   - Posez le tag sur le lecteur
   - R√©p√©tez pour chaque playlist

#### üë∂ Utilisation par l'enfant (quotidienne)

1. **L'enfant choisit** son tag (ex: le tag avec l'image de dinosaure)
2. **Il pose le tag** sur le lecteur The Open Music Box
3. **La lecture d√©marre** automatiquement! üéâ
4. **Contr√¥les simples**:
   - Bouton ‚ñ∂Ô∏è : Pause/Lecture
   - Bouton ‚è≠Ô∏è : Piste suivante
   - Bouton ‚èÆÔ∏è : Piste pr√©c√©dente
   - Molette üîä : Volume (tourner pour ajuster)

**C'est tout! Aucune aide parentale n√©cessaire au quotidien.**

---

## 8. Pr√©requis pour le d√©ploiement

### Mat√©riel

- ‚úÖ Raspberry Pi 3/4/5 avec Raspbian OS
- ‚úÖ Carte SD (16GB minimum, 32GB recommand√©)
- ‚úÖ Connexion r√©seau stable (WiFi ou Ethernet)
- ‚úÖ Alimentation adapt√©e au mod√®le de Pi
- ‚úÖ Carte audio WM8960 HAT (pour audio)
- ‚úÖ Lecteur NFC PN532 (pour tags NFC)

### Logiciel (sur votre ordinateur)

- ‚úÖ SSH client (inclus sur macOS/Linux, [PuTTY](https://www.putty.org/) sur Windows)
- ‚úÖ Raspberry Pi Imager
- ‚úÖ Cl√© SSH configur√©e
- ‚úÖ Acc√®s r√©seau au Raspberry Pi

### R√©seau

- ‚úÖ Raspberry Pi et ordinateur sur le m√™me r√©seau
- ‚úÖ mDNS activ√© (pour r√©solution de `*.local`)
- ‚úÖ Port 5004 accessible (pour l'interface web)
- ‚úÖ Port 22 accessible (pour SSH)

---

## üèóÔ∏è Architecture technique

> Cette section d√©taille l'architecture logicielle du projet pour les d√©veloppeurs et contributeurs. Si vous √™tes un utilisateur final, vous pouvez passer directement √† la section [Troubleshooting](#-troubleshooting).

### Vue d'ensemble

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Interface Web     ‚îÇ
‚îÇ   (Vue.js 3)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ HTTP + WebSocket
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Backend API       ‚îÇ
‚îÇ   (FastAPI/Python)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ           ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Audio  ‚îÇ  ‚îÇ  NFC   ‚îÇ
‚îÇ WM8960 ‚îÇ  ‚îÇ PN532  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Stack technique

**Backend:**
- Python 3.9+
- FastAPI (API REST)
- Socket.IO (WebSocket)
- SQLite (Base de donn√©es)
- pygame (Lecture audio)

**Frontend:**
- Vue.js 3 (Composition API)
- Pinia (State management)
- Socket.IO Client
- Axios (HTTP client)
- Vite (Build tool)

**Hardware:**
- Raspberry Pi 3/4/5
- WM8960 Audio HAT (Waveshare)
- PN532 NFC Reader
- Boutons GPIO + encodeur rotatif

### Principes architecturaux

- **DDD (Domain-Driven Design)**: S√©paration claire des couches
- **√âtat serveur autoritaire**: Le serveur est la source de v√©rit√©
- **√âv√©nements s√©quenc√©s**: Synchronisation fiable avec `server_seq`
- **Abstraction hardware**: Code testable ind√©pendamment du mat√©riel

Pour plus de d√©tails, consultez la [documentation d'architecture](documentation/backend-services-architecture.md).

---

## üìö Documentation technique

Pour approfondir vos connaissances sur l'architecture et le d√©veloppement:

### Documentation backend

- **[Backend README](back/README.md)**: Architecture backend d√©taill√©e avec exemples
- **[Architecture des services](documentation/backend-services-architecture.md)**: Design patterns et couches logicielles
- **[API et WebSocket](documentation/api-socketio-communication.md)**: Protocoles de communication en temps r√©el

### Documentation frontend

- **[Architecture frontend](documentation/frontend-architecture.md)**: Structure Vue.js et state management
- **[Guide de style UI](documentation/ui_theme.md)**: Th√®me visuel et composants

### Documentation d√©veloppeur

- **[Guide d√©veloppeur](documentation/developer-guide.md)**: Workflows et conventions de code
- **[Deploy Guide](DEPLOY_GUIDE.md)**: Guide de d√©ploiement avanc√©

### Ressources utiles

- üöÄ [`deploy.sh`](deploy.sh) - Script de d√©ploiement unifi√©
- üîß [`setup_ssh_key_to_rpi.sh`](setup_ssh_key_to_rpi.sh) - Configuration SSH automatique
- üì¶ [`build_public_release.sh`](build_public_release.sh) - Build pour distribution publique

### Liens externes

- [Raspberry Pi Documentation](https://www.raspberrypi.com/documentation/)
- [WM8960 Audio HAT Wiki](https://www.waveshare.com/wiki/WM8960_Audio_HAT)
- [PN532 NFC Module Guide](https://www.nxp.com/docs/en/user-guide/141520.pdf)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Vue.js Documentation](https://vuejs.org/)

---

## üíª D√©veloppement

> Cette section s'adresse aux d√©veloppeurs souhaitant contribuer au projet ou le personnaliser.

### Configuration de l'environnement

```bash
# Clone du repository
git clone https://github.com/yourusername/tomb-rpi.git
cd tomb-rpi

# Backend
cd back
python -m venv venv
source venv/bin/activate  # Linux/Mac
# ou venv\Scripts\activate  # Windows
pip install -r requirements/dev.txt

# Frontend
cd ../front
npm install

# Variables d'environnement
cp back/.env.example back/.env
# Modifiez back/.env selon vos besoins
```

### Lancement en d√©veloppement

```bash
# Backend (terminal 1)
cd back
source venv/bin/activate
python start_dev.py

# Frontend (terminal 2)
cd front
npm run dev
```

L'application sera accessible sur:
- Frontend: `http://localhost:5173`
- Backend API: `http://localhost:5004`
- API Docs: `http://localhost:5004/docs`

### Tests

```bash
# Backend: tous les tests
cd back
USE_MOCK_HARDWARE=true python -m pytest

# Backend: tests sp√©cifiques
USE_MOCK_HARDWARE=true python -m pytest tests/unit/
USE_MOCK_HARDWARE=true python -m pytest tests/integration/

# Frontend: tests
cd front
npm run test

# Frontend: coverage
npm run test:coverage
```

### D√©ploiement local

```bash
# D√©ploiement complet en d√©veloppement
./deploy.sh --dev

# Tests seulement
./deploy.sh --test-only

# Build seulement
./deploy.sh --build-only
```

---

## üîß Troubleshooting

### Probl√®mes courants

#### üî¥ Erreur SSH: "Connection refused"

**Causes possibles:**
- SSH non activ√© sur le Pi
- Mauvaise adresse IP/hostname
- Pare-feu bloque la connexion

**Solutions:**
```bash
# V√©rifier si le Pi r√©pond
ping theopenmusicbox.local

# Tester SSH avec verbose
ssh -v tomb

# Se connecter avec IP directe
ssh admin@192.168.1.xxx

# V√©rifier configuration SSH
cat ~/.ssh/config
```

#### üî¥ Erreur audio: "No sound"

**Causes possibles:**
- WM8960 mal connect√©
- Drivers non install√©s
- Volume muet

**Solutions:**
```bash
# R√©installer drivers WM8960
cd ~/WM8960-Audio-HAT
sudo ./install.sh
sudo reboot

# V√©rifier carte audio d√©tect√©e
aplay -l

# Tester lecture
aplay /usr/share/sounds/alsa/Front_Center.wav

# Ajuster volume
alsamixer
```

#### üî¥ Service ne d√©marre pas

**Causes possibles:**
- Erreur dans `.env`
- D√©pendances manquantes
- Port d√©j√† utilis√©

**Solutions:**
```bash
# Voir les erreurs d√©taill√©es
sudo journalctl -u app.service -n 50

# V√©rifier configuration
cat /home/admin/tomb/.env

# Tester manuellement
cd /home/admin/tomb
source venv/bin/activate
python start_app.py

# V√©rifier port disponible
sudo netstat -tulpn | grep 5004
```

#### üî¥ Tags NFC non d√©tect√©s

**Causes possibles:**
- PN532 mal connect√©
- Drivers I2C non charg√©s
- Tag incompatible

**Solutions:**
```bash
# Activer I2C
sudo raspi-config
# Interface Options > I2C > Enable

# V√©rifier d√©tection I2C
sudo i2cdetect -y 1
# Devrait montrer "24" √† l'adresse 0x24

# Red√©marrer service
sudo systemctl restart app
```

#### üî¥ Interface web inaccessible

**Causes possibles:**
- Service arr√™t√©
- Pare-feu bloque le port
- Mauvaise URL

**Solutions:**
```bash
# V√©rifier service actif
sudo systemctl status app

# V√©rifier port ouvert
sudo netstat -tulpn | grep 5004

# Trouver IP du Pi
hostname -I

# Tester depuis le Pi
curl http://localhost:5004/api/health
```

#### üî¥ Upload de fichiers √©choue

**Causes possibles:**
- Espace disque insuffisant
- Permissions incorrectes
- Format audio non support√©

**Solutions:**
```bash
# V√©rifier espace disque
df -h

# V√©rifier permissions
ls -la /home/admin/tomb/app/data/

# Corriger permissions
sudo chown -R admin:admin /home/admin/tomb/app/data/
sudo chmod -R 755 /home/admin/tomb/app/data/

# Formats support√©s: MP3, FLAC, WAV, OGG, M4A
```

### Logs de d√©bogage

Pour un diagnostic approfondi:

```bash
# Logs syst√®me complets
sudo journalctl -u app.service --no-pager

# Logs avec timestamps
sudo journalctl -u app.service -o short-iso

# Logs depuis le dernier boot
sudo journalctl -u app.service -b

# Exporter logs dans un fichier
sudo journalctl -u app.service > ~/app_logs.txt
```

### R√©initialisation compl√®te

Si tout √©choue, r√©installez:

```bash
# Arr√™ter et d√©sactiver service
sudo systemctl stop app
sudo systemctl disable app

# Supprimer installation
rm -rf /home/admin/tomb

# Red√©ployer
./deploy.sh --prod tomb
```

---

## ü§ù Contribution

Les contributions sont les bienvenues! Voici comment contribuer:

1. **Fork** le projet
2. **Cr√©ez une branche** pour votre fonctionnalit√© (`git checkout -b feature/AmazingFeature`)
3. **Committez** vos changements (`git commit -m 'Add some AmazingFeature'`)
4. **Push** vers la branche (`git push origin feature/AmazingFeature`)
5. **Ouvrez une Pull Request**

### Guidelines

- Suivez les conventions de code existantes
- Ajoutez des tests pour les nouvelles fonctionnalit√©s
- Documentez les changements dans le README si n√©cessaire
- Assurez-vous que tous les tests passent avant de soumettre

### Signaler un bug

Ouvrez une [issue](https://github.com/yourusername/tomb-rpi/issues) en incluant:

- Description d√©taill√©e du probl√®me
- Steps pour reproduire
- Comportement attendu vs comportement observ√©
- Version du syst√®me, mat√©riel utilis√©
- Logs pertinents

---

## üìÑ License

Ce projet est open source avec les conditions suivantes:

- ‚úÖ **Usage libre**: Utilisation, copie, modification, distribution pour usage **non commercial**
- ‚úÖ **Contributions**: Ouvertes √† tous via pull requests et issues
- ‚ö†Ô∏è **Usage commercial r√©serv√©**: La mon√©tisation (vente, services payants, int√©gration dans produits payants) est **r√©serv√©e exclusivement √† l'auteur original (Jonathan Piette)**
- üíº **Licence commerciale**: Contactez l'auteur pour options de licence commerciale

Voir le fichier [LICENSE](LICENSE) pour plus de d√©tails.

---

## üìß Contact

**Jonathan Piette** - Cr√©ateur et mainteneur

- üêô GitHub: [@yourusername](https://github.com/yourusername)
- üìß Email: your.email@example.com
- üí¨ Discord: [The Open Music Box Community](#) *(√† cr√©er)*

### Support

- üêõ **Bugs**: Ouvrez une [issue](https://github.com/yourusername/tomb-rpi/issues)
- üí° **Feature requests**: Ouvrez une [issue](https://github.com/yourusername/tomb-rpi/issues) avec le tag "enhancement"
- üí¨ **Questions**: Utilisez les [Discussions](https://github.com/yourusername/tomb-rpi/discussions)
- üìñ **Documentation**: Consultez le dossier [documentation/](documentation/)

---

## üôè Remerciements

- [FastAPI](https://fastapi.tiangolo.com/) pour le framework web
- [Vue.js](https://vuejs.org/) pour le framework frontend
- [Waveshare](https://www.waveshare.com/) pour le WM8960 Audio HAT
- [NXP](https://www.nxp.com/) pour le PN532 NFC reader
- La communaut√© [Raspberry Pi](https://www.raspberrypi.com/)
- Tous les [contributeurs](https://github.com/yourusername/tomb-rpi/contributors) du projet

---

## üéµ Amusez-vous bien avec The Open Music Box!

Si ce projet vous pla√Æt, n'h√©sitez pas √† lui donner une ‚≠ê sur GitHub!

---

<p align="center">
  Made with ‚ù§Ô∏è by Jonathan Piette<br>
  <sub>Transforming the way we interact with music</sub>
</p>
